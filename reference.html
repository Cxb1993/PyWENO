<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Reference &mdash; PyWENO v0.7.2 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.7.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/http://www.unc.edu/~mwemmett/jsmath/easy/load.js"></script>
    <link rel="top" title="PyWENO v0.7.2 documentation" href="index.html" />
    <link rel="next" title="What’s new" href="whatsnew.html" />
    <link rel="prev" title="Code generation" href="codegen.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="whatsnew.html" title="What’s new"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="codegen.html" title="Code generation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PyWENO v0.7.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="weno-scikit">
<h2>WENO SciKit<a class="headerlink" href="#weno-scikit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="scikits.weno.reconstruct">
<tt class="descclassname">scikits.weno.</tt><tt class="descname">reconstruct</tt><big>(</big><em>q</em>, <em>k</em>, <em>points</em>, <em>n=None</em>, <em>smoothness=None</em>, <em>weights=None</em>, <em>return_smoothness=False</em>, <em>return_weights=False</em>, <em>squeeze=True</em><big>)</big><a class="headerlink" href="#scikits.weno.reconstruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform WENO reconstruction of q.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>q</em> &#8211; cell-averaged unknown to reconstruct</li>
<li><em>k</em> &#8211; order of reconstruction (odd values from 5 to 11)</li>
<li><em>points</em> &#8211; reconstruction points (see below)</li>
<li><em>n</em> &#8211; number of reconstruction points (see below, optional)</li>
<li><em>smoothness</em> &#8211; use smoothness indicators <em>smoothness</em> (optional)</li>
<li><em>weights</em> &#8211; use non-linear weights <em>weights</em> (optional)</li>
<li><em>return_smoothness</em> &#8211; return smoothness indicators? (defaults to <tt class="xref docutils literal"><span class="pre">False</span></tt>)</li>
<li><em>return_weights</em> &#8211; return weights? (defaults to <tt class="xref docutils literal"><span class="pre">False</span></tt>)</li>
<li><em>squeeze</em> &#8211; squeeze the results? (defaults to <tt class="xref docutils literal"><span class="pre">True</span></tt>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Supported reconstruction points <em>points</em> are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'left'</span></tt> - left edge of each cell</li>
<li><tt class="docutils literal"><span class="pre">'right'</span></tt> - right edge of each cell</li>
<li><tt class="docutils literal"><span class="pre">'middle'</span></tt> - the middle of each cell</li>
<li><tt class="docutils literal"><span class="pre">'+/-'</span></tt> - returns two reconstructions per cell, both at the left
edge of each cell; the first is considered as a limit from the
left (-), the second is considered as a limit from the right (+).</li>
<li><tt class="docutils literal"><span class="pre">'gauss'</span></tt> or <tt class="docutils literal"><span class="pre">'gauss_legendre'</span></tt> - <em>n</em> point Gauss-Legendre
quadrature points</li>
<li><tt class="docutils literal"><span class="pre">'gauss_lobatto'</span></tt> - <em>n</em> point Gauss-Lobatto quadrature points</li>
<li><tt class="docutils literal"><span class="pre">'gauss_radau'</span></tt> - <em>n</em> point Gauss-Radau quadrature points</li>
</ul>
<p>This function wraps several complied WENO kernels which were
generated by PyWENO.  If you need WENO reconstructions at points not
supported by this wrapper, please checkout <a class="reference external" href="http://memmett.github.com/PyWENO/">PyWENO</a>.</p>
</dd></dl>

<dl class="function">
<dt id="scikits.weno.coeffs">
<tt class="descclassname">scikits.weno.</tt><tt class="descname">coeffs</tt><big>(</big><em>xi</em>, <em>i</em>, <em>r</em>, <em>k</em>, <em>x</em>, <em>c</em><big>)</big><a class="headerlink" href="#scikits.weno.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerically compute the reconstruction coefficients.</p>
<p>The reconstruction coefficients <em>c_j</em> are used to approximate the
function <em>f</em> given its cell averages <em>f_j</em> according to</p>
<div class="math">
f(\xi) \approx \sum_{j=0}^{k-1} c_j\, \overline{f}_{i-r+j}.</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>xi</em> &#8211; reconstruction point</li>
<li><em>i</em> &#8211; cell index (ie, index of the cell that containts <em>xi</em>)</li>
<li><em>r</em> &#8211; left shift</li>
<li><em>k</em> &#8211; order</li>
<li><em>x</em> &#8211; cell boundaries</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="symbolics">
<h2>Symbolics<a class="headerlink" href="#symbolics" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyweno.symbolic.polynomial_interpolator">
<tt class="descclassname">pyweno.symbolic.</tt><tt class="descname">polynomial_interpolator</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#pyweno.symbolic.polynomial_interpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a symbolic polynomial that interpolates the points (x_i, y_i).</p>
<p>The returned polynomial is a function of the SymPy variable x.</p>
</dd></dl>

<dl class="function">
<dt id="pyweno.symbolic.primitive_polynomial_interpolator">
<tt class="descclassname">pyweno.symbolic.</tt><tt class="descname">primitive_polynomial_interpolator</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#pyweno.symbolic.primitive_polynomial_interpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a symbolic polynomial that approximates the primitive
function f such that f(x_i) = sum_j y_j * (x_{j+1} - x_{j}).</p>
<p>The returned polynomial is a function of the SymPy variable &#8216;x&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pyweno.symbolic.reconstruction_coefficients">
<tt class="descclassname">pyweno.symbolic.</tt><tt class="descname">reconstruction_coefficients</tt><big>(</big><em>k</em>, <em>xi</em><big>)</big><a class="headerlink" href="#pyweno.symbolic.reconstruction_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the reconstruction coefficients for a 2k-1 order WENO
scheme corresponding to the reconstruction points in <em>xi</em>.</p>
<p>The reconstruction points in <em>xi</em> should in <span class="math">[-1, 1]</span>.  This
interval is then mapped to the cell <span class="math">[x_{i-1/2}, x_{i+1/2}]</span>.</p>
<p>The returned coefficients are stored as SymPy variables in an
ndarray indexed according to <tt class="docutils literal"><span class="pre">c[l,r,j]</span></tt>.  That is</p>
<div class="math">
f^r(\xi_l) \approx \sum_j c^{l,r}_j \, f_{i-r+j}</div>
<p>for each <span class="math">l</span> from 0 to <tt class="docutils literal"><span class="pre">len(xi)</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="pyweno.symbolic.optimal_weights">
<tt class="descclassname">pyweno.symbolic.</tt><tt class="descname">optimal_weights</tt><big>(</big><em>k</em>, <em>xi</em><big>)</big><a class="headerlink" href="#pyweno.symbolic.optimal_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the optimal weights for a 2k-1 order WENO scheme
corresponding to the reconstruction points in <em>xi</em>.</p>
<p>The coefficients are stored as SymPy variables in an ndarray
indexed according to <tt class="docutils literal"><span class="pre">w[l,r]</span></tt>.  That is</p>
<div class="math">
f(\xi^l) \approx \sum_r w^r f^r</div>
<p>for each <span class="math">l</span> from 0 to <tt class="docutils literal"><span class="pre">len(xi)</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="pyweno.symbolic.jiang_shu_smoothness_coefficients">
<tt class="descclassname">pyweno.symbolic.</tt><tt class="descname">jiang_shu_smoothness_coefficients</tt><big>(</big><em>k</em><big>)</big><a class="headerlink" href="#pyweno.symbolic.jiang_shu_smoothness_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Jiang-Shu smoothness coefficients for a 2k-1 order
WENO scheme.</p>
<p>The coefficients are stored as SymPy variables in an array
indexed according to <tt class="docutils literal"><span class="pre">beta[r,m,n]</span></tt>.  That is</p>
<div class="math">
\sigma^r = \sum_{m=1}^{2k-1} \sum_{n=1}^{2k-1}
  \beta_{r,m,n}\, \overline{f}_{i-k+m}\, \overline{f}_{i-k+n}.</div>
</dd></dl>

</div>
<div class="section" id="code-generation">
<h2>Code generation<a class="headerlink" href="#code-generation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyweno.kernels">
<h3>Kernels<a class="headerlink" href="#module-pyweno.kernels" title="Permalink to this headline">¶</a></h3>
<p>PyWENO code generation tool kit (kernels).</p>
<dl class="class">
<dt id="pyweno.kernels.KernelGenerator">
<em class="property">
class </em><tt class="descclassname">pyweno.kernels.</tt><tt class="descname">KernelGenerator</tt><big>(</big><em>lang</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyweno.kernels.KernelGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate kernels for WENO reconstructions.</p>
<p>Each method generates a &#8216;kernel&#8217; for a specific WENO operation:
computing smoothness indicators, non-linear weights, and
reconstructions.  These code snippets can, in-turn, be used to
create seperate functions or larger kernels.</p>
<p>The <em>basenames</em> dictionary is used to define naming conventions:</p>
<ul class="simple">
<li>smoothness indicators: <em>sigma</em>, default <tt class="docutils literal"><span class="pre">sigmaX</span></tt></li>
<li>weights: <em>omega</em>, default <tt class="docutils literal"><span class="pre">omegaX</span></tt></li>
<li>intermediate reconstructions: <em>fr</em>, default <tt class="docutils literal"><span class="pre">frX</span></tt>.</li>
</ul>
<p>For each of the above, the occurance of <tt class="docutils literal"><span class="pre">X</span></tt> is replaced by the
left-shift <em>r</em>.  For example, for <tt class="docutils literal"><span class="pre">k=3</span></tt> and <tt class="docutils literal"><span class="pre">omega='omegaX'</span></tt>,
the weights are stored in <tt class="docutils literal"><span class="pre">omega0</span></tt>, <tt class="docutils literal"><span class="pre">omega1</span></tt>, and <tt class="docutils literal"><span class="pre">omega2</span></tt>,
each of which are assumed to be in scope.  In some routines the
accumulator variable <tt class="docutils literal"><span class="pre">acc</span></tt> is also assumed to be in scope.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>lang</em> &#8211; <tt class="docutils literal"><span class="pre">'c'</span></tt>, <tt class="docutils literal"><span class="pre">'opencl'</span></tt>, or <tt class="docutils literal"><span class="pre">'fortran'</span></tt></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyweno.kernels.KernelGenerator.reconstruction">
<tt class="descname">reconstruction</tt><big>(</big><big>)</big><a class="headerlink" href="#pyweno.kernels.KernelGenerator.reconstruction" title="Permalink to this definition">¶</a></dt>
<dd><p>Fully un-rolled reconstruction kernel for uniform grids.</p>
<p>The reconstruction kernel computes the WENO reconstruction
based on the weights <em>omega</em> (which have already been
computed) and the reconstruction coefficients <em>coeffs</em>.</p>
</dd></dl>

<dl class="method">
<dt id="pyweno.kernels.KernelGenerator.set_optimal_weights">
<tt class="descname">set_optimal_weights</tt><big>(</big><em>varpi</em>, <em>split</em><big>)</big><a class="headerlink" href="#pyweno.kernels.KernelGenerator.set_optimal_weights" title="Permalink to this definition">¶</a></dt>
<dd>Set the optimal (linear) weights.</dd></dl>

<dl class="method">
<dt id="pyweno.kernels.KernelGenerator.set_reconstruction_coefficients">
<tt class="descname">set_reconstruction_coefficients</tt><big>(</big><em>coeffs</em><big>)</big><a class="headerlink" href="#pyweno.kernels.KernelGenerator.set_reconstruction_coefficients" title="Permalink to this definition">¶</a></dt>
<dd>Set the reconstruction coefficients.</dd></dl>

<dl class="method">
<dt id="pyweno.kernels.KernelGenerator.set_smoothness">
<tt class="descname">set_smoothness</tt><big>(</big><em>beta</em><big>)</big><a class="headerlink" href="#pyweno.kernels.KernelGenerator.set_smoothness" title="Permalink to this definition">¶</a></dt>
<dd>Set the smoothness indicator coefficients.</dd></dl>

<dl class="method">
<dt id="pyweno.kernels.KernelGenerator.smoothness">
<tt class="descname">smoothness</tt><big>(</big><big>)</big><a class="headerlink" href="#pyweno.kernels.KernelGenerator.smoothness" title="Permalink to this definition">¶</a></dt>
<dd><p>Fully un-rolled smoothness indicator kernel for uniform
grids.</p>
<p>The smoothness indicator kernel computes the smoothness indicators
<em>sigma</em> determined by the coefficients in <em>beta</em>.  That is:</p>
<div class="math">
\sigma_r = \sum_{m=1}^{2k-1}
               \sum_{n=1}^{2k-1}
                   \beta_{r,m,n}\, \overline{f}_{i-k+m}\,
                                   \overline{f}_{i-k+n}.</div>
</dd></dl>

<dl class="method">
<dt id="pyweno.kernels.KernelGenerator.weights">
<tt class="descname">weights</tt><big>(</big><em>epsilon='1.0e-6'</em><big>)</big><a class="headerlink" href="#pyweno.kernels.KernelGenerator.weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Fully un-rolled weights kernel for uniform grids.</p>
<p>The weights kernel computes the weights <em>omega</em> determined by
the smoothness coefficients <em>sigma</em> (which have already been
computed).</p>
<p>XXX: have epsilon passed to function
XXX: pass power...</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyweno.wrappers">
<h3>Wrappers<a class="headerlink" href="#module-pyweno.wrappers" title="Permalink to this headline">¶</a></h3>
<p>PyWENO code generation module (wrappers).</p>
<dl class="class">
<dt id="pyweno.wrappers.WrapperGenerator">
<em class="property">
class </em><tt class="descclassname">pyweno.wrappers.</tt><tt class="descname">WrapperGenerator</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyweno.wrappers.WrapperGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate kernals and wrappers for WENO reconstructions.</p>
<p>Each method generates a function (and optionallly a Python wrapper)
for a specific WENO operation: computing smoothness indicators,
non-linear weights, and reconstructions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>lang</em> &#8211; <tt class="docutils literal"><span class="pre">'c'</span></tt>, <tt class="docutils literal"><span class="pre">'opencl'</span></tt>, or <tt class="docutils literal"><span class="pre">'fortran'</span></tt></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyweno.wrappers.WrapperGenerator.footer">
<tt class="descname">footer</tt><big>(</big><big>)</big><a class="headerlink" href="#pyweno.wrappers.WrapperGenerator.footer" title="Permalink to this definition">¶</a></dt>
<dd>Return C Python extension module footer.</dd></dl>

<dl class="method">
<dt id="pyweno.wrappers.WrapperGenerator.header">
<tt class="descname">header</tt><big>(</big><em>module=''</em><big>)</big><a class="headerlink" href="#pyweno.wrappers.WrapperGenerator.header" title="Permalink to this definition">¶</a></dt>
<dd>Return C Python extension module header.</dd></dl>

<dl class="method">
<dt id="pyweno.wrappers.WrapperGenerator.reconstruction">
<tt class="descname">reconstruction</tt><big>(</big><em>function='reconstruct'</em>, <em>compute_smoothness=False</em>, <em>compute_weights=False</em>, <em>wrapper=False</em><big>)</big><a class="headerlink" href="#pyweno.wrappers.WrapperGenerator.reconstruction" title="Permalink to this definition">¶</a></dt>
<dd>Recontruction function.</dd></dl>

<dl class="method">
<dt id="pyweno.wrappers.WrapperGenerator.smoothness">
<tt class="descname">smoothness</tt><big>(</big><em>function='smoothness'</em>, <em>wrapper=False</em><big>)</big><a class="headerlink" href="#pyweno.wrappers.WrapperGenerator.smoothness" title="Permalink to this definition">¶</a></dt>
<dd>Smoothness function.</dd></dl>

<dl class="method">
<dt id="pyweno.wrappers.WrapperGenerator.weights">
<tt class="descname">weights</tt><big>(</big><em>function='weights'</em>, <em>wrapper=False</em><big>)</big><a class="headerlink" href="#pyweno.wrappers.WrapperGenerator.weights" title="Permalink to this definition">¶</a></dt>
<dd>Weights function.</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-pyweno.version">
<h2>Version<a class="headerlink" href="#module-pyweno.version" title="Permalink to this headline">¶</a></h2>
<p>PyWENO version information.</p>
<p>To obtain the version of PyWENO:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyweno.version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyweno</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyweno</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">git_version</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Reference</a><ul>
<li><a class="reference external" href="#weno-scikit">WENO SciKit</a></li>
<li><a class="reference external" href="#symbolics">Symbolics</a></li>
<li><a class="reference external" href="#code-generation">Code generation</a><ul>
<li><a class="reference external" href="#module-pyweno.kernels">Kernels</a></li>
<li><a class="reference external" href="#module-pyweno.wrappers">Wrappers</a></li>
</ul>
</li>
<li><a class="reference external" href="#module-pyweno.version">Version</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="codegen.html"
                                  title="previous chapter">Code generation</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="whatsnew.html"
                                  title="next chapter">What&#8217;s new</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/reference.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="whatsnew.html" title="What’s new"
             >next</a> |</li>
        <li class="right" >
          <a href="codegen.html" title="Code generation"
             >previous</a> |</li>
        <li><a href="index.html">PyWENO v0.7.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, 2010, 2011, Matthew Emmett.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>